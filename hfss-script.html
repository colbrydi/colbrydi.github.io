<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Dirk's Home Page - HFSS script</title>
    <meta name="description" content="">
    <meta name="author" content="Dr. Dirk Colbry">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="./theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="./theme/bootstrap.min.css" rel="stylesheet">
    <link href="./theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="./theme/local.css" rel="stylesheet">
    <link href="./theme/pygments.css" rel="stylesheet">

    <!-- So Firefox can bookmark->"abo this site" -->

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
   <img src="./images/2017Dirk.jpg" align="left" width=100 hspace="20">

    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href=".">Dirk's Home Page</a>

        <div class="nav-collapse">
        <ul class="nav">
            <li><a href="/pages/teaching.html">Teaching</a></li>
            <li><a href="/category/professional.html">Blog</a></li>
            <li><a href="/pages/publications.html">Publications</a></li>
            <li><a href="/pages/contact.html">Contact</a></li>
            
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
    <div class='article'>
        <div class="content-title">
            <h1>HFSS script</h1>
Wed 08 June 2011

by <a class="url fn" href="./author/dr-dirk-colbry.html">Dr. Dirk Colbry</a>
 


        </div>
	
        <div><p>Blog post <strong>edited</strong> by [Pat Bills](
https://wiki.hpcc.msu.edu/display/~billspat@msu.edu</p>
<p>) - "Migration of unmigrated content due to installation of a new plugin"</p>
<p>HFSS is available on the MSU HPCC. You can run interactively or in batch mode.</p>
<p>You may run the GUI interactive using the iCER Remote Desktop Gateway. See
<a href="https://wiki.hpcc.msu.edu/pages/[viewpage.action](./images/viewpage.action)?pageId=1343579">Copy of Connecting with a Remote Desktop
Client</a></p>
<p>you must run HFSS from a development node via a terminal</p>
<p>Connect to the iCER Remote Desktop Gateway</p>
<p>Start a Terminal by clicking The Applications Menu and selecting "Terminal
Emulator"</p>
<p>Once in the terminal, connect to a Development Node, Load the module for HFSS,
and start hfss. When you run for the firs time, it will create a configuration
setup for you. This may take a bit, and appear to be stalled, but please be
patient if the system is busy.</p>
<p><strong>Start HFSS in the Terminal</strong></p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">billspat</span><span class="err">@</span><span class="n">rdpgw</span><span class="o">-</span><span class="mi">00</span> <span class="o">~</span><span class="p">]</span><span class="o">$</span> <span class="n">ssh</span> <span class="n">dev</span><span class="o">-</span><span class="n">intel14</span>
<span class="p">[</span><span class="n">billspat</span><span class="err">@</span><span class="n">dev</span><span class="o">-</span><span class="n">intel14</span> <span class="o">~</span><span class="p">]</span><span class="o">$</span> <span class="n">module</span> <span class="nb">load</span> <span class="n">hfss</span>
<span class="n">Lmod</span> <span class="n">Warning</span><span class="p">:</span> <span class="n">hfss</span> <span class="ow">not</span> <span class="n">found</span><span class="p">,</span> <span class="n">loading</span><span class="p">:</span> <span class="n">HFSS</span><span class="o">/</span><span class="mf">15.0</span>

<span class="p">[</span><span class="n">billspat</span><span class="err">@</span><span class="n">eval</span><span class="o">-</span><span class="n">k40</span> <span class="o">~</span><span class="p">]</span><span class="o">$</span> <span class="n">hfss</span>
<span class="n">ANSYS</span> <span class="n">Electromagnetics</span> <span class="mf">15.0</span> <span class="n">Configuration</span>
<span class="o">=========================================</span>
<span class="n">Hostname</span><span class="p">:</span> <span class="n">eval</span><span class="o">-</span><span class="n">k40</span>
<span class="n">User</span><span class="p">:</span>     <span class="n">billspat</span>
<span class="o">&gt;</span> <span class="n">Running</span> <span class="n">first</span><span class="o">-</span><span class="n">time</span> <span class="n">configuration</span><span class="o">...</span>
  <span class="o">-</span> <span class="o">***</span> <span class="n">Skipping</span> <span class="n">dependency</span> <span class="n">verification</span> <span class="n">test</span> <span class="o">***</span>
  <span class="o">-</span> <span class="n">Retrieving</span> <span class="n">user</span> <span class="n">settings</span><span class="o">...</span> <span class="n">Done</span>
  <span class="o">-</span> <span class="n">Applying</span> <span class="n">user</span> <span class="n">settings</span><span class="o">...</span> <span class="n">Done</span>
  <span class="o">-</span> <span class="n">Configuring</span> <span class="n">OCX</span> <span class="n">files</span><span class="o">...</span> <span class="n">Done</span>
  <span class="o">-</span> <span class="n">Retrieving</span> <span class="n">machine</span> <span class="n">settings</span><span class="o">...</span> <span class="n">Done</span>
  <span class="o">-</span> <span class="n">Applying</span> <span class="n">machine</span> <span class="n">settings</span><span class="o">...</span> <span class="n">Done</span>
  <span class="o">-</span> <span class="n">Configuring</span> <span class="n">binaries</span><span class="o">...</span> <span class="n">Done</span>
<span class="n">First</span><span class="o">-</span><span class="n">time</span> <span class="n">configuration</span> <span class="n">completed</span> <span class="n">successfully</span><span class="o">.</span>
</code></pre></div>

<p>At which point the GUI/ Window will start. It will ask you a question about
which directories you'd like to use. Please change the scratch folder:</p>
<p><img alt="" src="https://wiki.hpcc.msu.edu/download/attachments/5411556/hfss-folderchoice.png?version=1&amp;modificationDate=1441138478000&amp;api=v2">The default scratch directory is simply /mnt/scratch. We suggest you createyour own folder on scratch, and enter that folder here. You have to firstcheck the "override" box and then type in your scratch folder.You may also use Batch mode to run HFSS jobs on the cluster. Here is anexample HFSS 15.0 submission script written by Andrew Temme that sets up theHFSS job options. For more detail see his excellent <a href="http://nbviewer.ipython.org/urls/bitbucket.org/temmeand/example-ipython-notebooks/raw/master/MSU-supercomputer-HFSS-and-IPython.ipynb">Python Notebook onHFSS</a></p>
<p><strong>hfssrun.qsub</strong></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash -login</span>
<span class="c1">#PBS -l walltime=03:59:00,mem=50gb,nodes=19:ppn=1</span>
<span class="c1">#PBS -j oe</span>
<span class="c1">#PBS -m abe</span>
<span class="c1">#PBS -W x=gres:hfss_solve</span>

module load HFSS/15.0
<span class="nb">export</span> <span class="nv">OptFile</span><span class="o">=</span><span class="si">${</span><span class="nv">PBS_O_WORKDIR</span><span class="si">}</span>/Options.txt
<span class="nb">export</span> <span class="nv">ANSYSEM_JOB_ID</span><span class="o">=</span><span class="si">${</span><span class="nv">PBS_JOBID</span><span class="si">}</span>
<span class="nb">export</span> <span class="nv">ANSYSEM_HOST_FILE</span><span class="o">=</span><span class="nv">$PBS_NODEFILE</span>
<span class="nb">export</span> <span class="nv">LINUX_SSH_BINARY_PATH</span><span class="o">=</span>/usr/bin
<span class="nb">export</span> <span class="nv">ANSYSEM_LINUX_HPC_UTILS</span><span class="o">=</span>/opt/software/AnsysEM/15.0/AnsysEM15.0/Linux64/schedulers/utils

<span class="nb">cd</span> <span class="si">${</span><span class="nv">PBS_O_WORKDIR</span><span class="si">}</span>
<span class="c1"># mkdir -p ${PBS_O_WORKDIR}/scratch</span>

<span class="nb">echo</span> creating batch options list
<span class="nb">echo</span> <span class="se">\$</span>begin <span class="se">\&#39;</span>Config<span class="se">\&#39;</span> &gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS/NumCoresPerDistributedTask<span class="se">\&#39;</span><span class="o">=</span><span class="si">${</span><span class="nv">PBS_NUM_PPN</span><span class="si">}</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS/HPCLicenseType<span class="se">\&#39;</span><span class="o">=</span><span class="se">\&#39;</span>Pool<span class="se">\&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS/SolveAdaptiveOnly<span class="se">\&#39;</span><span class="o">=</span><span class="m">0</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS/MPIVendor<span class="se">\&#39;</span><span class="o">=</span> <span class="se">\&#39;</span>Intel<span class="se">\&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS-IE/NumCoresPerDistributedTask<span class="se">\&#39;</span><span class="o">=</span><span class="si">${</span><span class="nv">PBS_NUM_PPN</span><span class="si">}</span>  &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS-IE/HPCLicenseType<span class="se">\&#39;</span><span class="o">=</span><span class="se">\&#39;</span>Pool<span class="se">\&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS-IE/SolveAdaptiveOnly<span class="se">\&#39;</span><span class="o">=</span><span class="m">0</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="nb">echo</span> <span class="se">\&#39;</span>HFSS-IE/MPIVendor<span class="se">\&#39;</span><span class="o">=</span><span class="se">\&#39;</span>Intel<span class="se">\&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
<span class="c1"># echo \&#39;tempdirectory\&#39;=\&#39;${PBS_O_WORKDIR}/scratch\&#39; &gt;&gt; ${OptFile}</span>
<span class="nb">echo</span> <span class="se">\$</span>end <span class="se">\&#39;</span>Config<span class="se">\&#39;</span> &gt;&gt; <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>
chmod <span class="m">777</span> <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span>

hfss -ng -monitor -distributed -machinelist <span class="nv">num</span><span class="o">=</span><span class="si">${</span><span class="nv">PBS_NUM_NODES</span><span class="si">}</span> -batchoptions <span class="si">${</span><span class="nv">OptFile</span><span class="si">}</span> -BatchSolve <span class="si">${</span><span class="nv">PBS_JOBNAME</span><span class="si">}</span>.hfss
</code></pre></div>
</td></tr></table>
<p><a href="https://wiki.hpcc.msu.edu/display/~colbrydi@msu.edu/2011/06/08/HFSS+script">View
Online</a></p>
<p>Blogpost migrated from <a href="https://wiki.hpcc.msu.edu/display/~colbrydi@msu.edu/2011/06/08/HFSS+script">ICER Wiki</a> using custom python script. Comment on errors below.</p></div>
	
        <hr>

        <h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'DirkColbry'; 
    var disqus_title = 'HFSS script';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="./archives.html">Archives</a>
                <li><a href="./tags.html">Tags</a>




            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                <li><a href="./category/fun.html">Fun</a></li>
                <li><a href="./category/professional.html">Professional</a></li>
                   
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>
            
                <li><a href="//colbrydi.github.io/cyberambassadors/">CyberAmbassadors</a></li>
                <li><a href="//see-insight.github.io/">SEE-Insight</a></li>
                <li><a href="//colbrydi.github.io/msupelican/">Pelican / Github.io Tutorial</a></li>
                <li><a href="//cmse.msu.edu">CMSE</a></li>
                <li><a href="//www.msu.edu/">MSU</a></li>
            </ul>
            </div>



        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href=".">Dirk's Home Page</a> &copy; Dr. Dirk Colbry 2022</p>
</footer>

</div> <!-- /container -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="./theme/bootstrap-collapse.js"></script>
<script>var _gaq=[['_setAccount','UA-121560886-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
 
</body>
</html>